import{r as t,j as e,a as p,z as o,u as B,H as O}from"./app-DT32C7nY.js";import{M as $,S as F,T as z,A as H,C as I}from"./Table-CL22LIrt.js";import{u as q,F as R,a as J,o as L,c as U,b as V}from"./index.esm-Ci-6NNXr.js";import{B as C}from"./Button-DkoYT9R8.js";import{B as G}from"./Badge-ayPLFCxx.js";import{C as E,a as _,c as Q,b as W}from"./Card-DvLVLLze.js";import{P as X}from"./Pagination-DsMwMylt.js";import{A as Y}from"./AdminLayout-qkJBv-y2.js";import{P as Z}from"./plus-K_uxNSFF.js";import"./createLucideIcon-CMnZVN2_.js";import"./trash-2-BHSVLgJt.js";import"./chevron-right-bjn_y0tR.js";import"./users-D15wB9T6.js";import"./x-CHumAv0e.js";import"./user-DeY8Ogeh.js";const ee=U({nama_kategori:V().required("Nama kategori wajib diisi")});function K({isOpen:i,onClose:g,kategori:s=null,onSuccess:c}){const n=!!s,[m,u]=t.useState(!1),h=q({resolver:L(ee),defaultValues:{nama_kategori:""}}),{handleSubmit:f,reset:r}=h;t.useEffect(()=>{r(s?{nama_kategori:s.nama_kategori||""}:{nama_kategori:""})},[s,r]);const S=b=>{u(!0);const k=n?`/admin/kategori/${s.id}`:"/admin/kategori";p[n?"put":"post"](k,b,{onSuccess:()=>{l(),c&&c()},onError:d=>{console.error("Submit error:",d),d.message?o.error(d.message):Object.values(d).length>0?o.error(Object.values(d)[0]):o.error(`Terjadi kesalahan saat ${n?"mengubah":"menambah"} kategori`)},onFinish:()=>{u(!1)}})},l=()=>{r(),g()};return e.jsx($,{id:"modal-kategori",isOpen:i,onClose:l,size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold",children:n?"Edit Kategori":"Tambah Kategori"}),e.jsx(R,{...h,children:e.jsxs("form",{onSubmit:f(S),className:"space-y-4",children:[e.jsx(J,{name:"nama_kategori",label:"Nama Kategori",placeholder:"Contoh: Kue Ulang Tahun",disabled:m,required:!0}),e.jsxs("div",{className:"modal-action",children:[e.jsx(C,{variant:"outline",type:"button",onClick:l,disabled:m,children:"Batal"}),e.jsx(C,{variant:"primary",type:"submit",disabled:m,children:m?"Menyimpan...":n?"Simpan Perubahan":"Simpan"})]})]})})]})})}function fe({kategori:i,filters:g}){const{props:s}=B(),[c,n]=t.useState(g.search||""),[m,u]=t.useState(!1),[h,f]=t.useState(null),[r,S]=t.useState(g.sort||"nama_kategori"),[l,b]=t.useState(g.direction||"asc"),[k,x]=t.useState(!1),[d,v]=t.useState(!1),[N,y]=t.useState(null);t.useEffect(()=>{s.success&&o.success(s.success),s.error&&o.error(s.error)},[s.success,s.error]);const T=a=>{a.preventDefault(),p.get(route("admin.kategori.index"),{search:c,sort:r,direction:l},{preserveState:!0,preserveScroll:!0})},M=a=>{const j=r===a&&l==="asc"?"desc":"asc";S(a),b(j),p.get(route("admin.kategori.index"),{search:c,sort:a,direction:j},{preserveState:!0,preserveScroll:!0})},w=a=>{f(a),u(!0)},P=()=>{h&&p.delete(`/admin/kategori/${h.id}`,{preserveScroll:!0,onSuccess:()=>{u(!1),f(null)},onError:a=>{console.error("Delete error:",a),a.message?o.error(a.message):Object.values(a).length>0?o.error(Object.values(a)[0]):o.error("Terjadi kesalahan saat menghapus kategori")}})},A=a=>{y(a),v(!0)},D=()=>{v(!1),y(null)};return e.jsxs(Y,{auth:s.auth,header:"Data Kategori",children:[e.jsx(O,{title:"Data Kategori"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(E,{children:e.jsx(_,{children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx(F,{value:c,onChange:n,onSubmit:T,placeholder:"Cari kategori...",className:"flex-1"}),e.jsxs(C,{variant:"primary",className:"gap-2",onClick:()=>x(!0),children:[e.jsx(Z,{size:18}),"Tambah Kategori"]})]})})}),e.jsxs(E,{children:[e.jsx(Q,{children:e.jsxs(W,{children:["Daftar Kategori (",i.total,")"]})}),e.jsx(_,{className:"p-0",children:e.jsx(z,{headers:[{label:"No",key:"no",sortable:!1},{label:"Nama Kategori",key:"nama_kategori",sortable:!0},{label:"Jumlah Produk",key:"produk",sortable:!1},{label:"Aksi",key:"aksi",sortable:!1}],data:i.data,renderRow:(a,j)=>e.jsxs("tr",{children:[e.jsx("td",{children:(i.current_page-1)*i.per_page+j+1}),e.jsx("td",{children:a.nama_kategori}),e.jsx("td",{children:e.jsxs(G,{variant:"info",children:[a.produks_count||0," produk"]})}),e.jsx("td",{children:e.jsx(H,{onEdit:()=>A(a),onDelete:()=>w(a)})})]},a.id),emptyMessage:"Tidak ada data kategori",emptyColSpan:4,sortConfig:{key:r,direction:l},onSort:M})})]}),e.jsx(X,{links:i.links})]}),e.jsx(K,{isOpen:k,onClose:()=>x(!1),onSuccess:()=>{x(!1),p.reload()}}),e.jsx(K,{isOpen:d,onClose:D,kategori:N,onSuccess:()=>{D(),p.reload()}}),e.jsx(I,{isOpen:m,onClose:()=>u(!1),onConfirm:P,title:"Hapus Kategori",message:`Apakah Anda yakin ingin menghapus kategori "${h?.nama_kategori}"?`})]})}export{fe as default};
